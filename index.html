<!DOCTYPE html>
<html>
<head>
<title>BuyBuddy</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body {
  font-family: "Segoe UI", Arial, sans-serif;
  margin: 0;
  background: 
    linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
    url("https://t4.ftcdn.net/jpg/07/41/09/09/360_F_741090978_Oa4o8aEEKX9NPPZAhRHQCprzD29VwVen.jpg");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  color: #fff;
}

header {
  background: rgba(0, 0, 0, 0.55);
  padding: 25px;
  text-align: center;
  color: #f5f5f5;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  backdrop-filter: blur(10px);
}

header h1 {
  margin: 0;
  font-size: 38px;
  letter-spacing: 1px;
  color: #e3fdfd;
}

nav {
  margin-top: 12px;
}

nav input, nav select, nav button {
  padding: 8px 12px;
  margin: 6px;
  border-radius: 8px;
  border: 1px solid rgba(255,255,255,0.5);
  background: rgba(255,255,255,0.9);
  color: #333;
  transition: all 0.3s ease;
}

nav input:focus, nav select:focus {
  outline: none;
  border-color: #48c6ef;
  box-shadow: 0 0 6px rgba(72,198,239,0.6);
}

nav button {
  cursor: pointer;
  background: linear-gradient(135deg, #48c6ef, #6f86d6);
  color: white;
  font-weight: bold;
  border: none;
  box-shadow: 0 3px 8px rgba(0,0,0,0.25);
}

nav button:hover {
  background: linear-gradient(135deg, #6f86d6, #48c6ef);
  transform: translateY(-2px);
}

.container {
  padding: 60px;
}

.grid-container {
  display: grid;
  grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
  gap: 25px;
}

.product-card, .recommend-card {
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(12px);
  border-radius: 14px;
  padding: 18px;
  text-align: center;
  box-shadow: 0 6px 20px rgba(0,0,0,0.4);
  transition: all 0.3s ease;
  position: relative;
}

.product-card:hover, .recommend-card:hover {
  transform: translateY(-6px) scale(1.04);
  box-shadow: 0 10px 25px rgba(0,0,0,0.5);
}

.product-card img, .recommend-card img {
  width: 100%;
  border-radius: 10px;
  margin-bottom: 12px;
}

.product-card button, .recommend-card button {
  background: linear-gradient(135deg, #00c6ff, #0072ff);
  border: none;
  padding: 10px;
  color: white;
  font-weight: bold;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  width: 100%;
}

.product-card button:hover, .recommend-card button:hover {
  background: linear-gradient(135deg, #0072ff, #00c6ff);
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  transform: scale(1.05);
}

.form-box {
  max-width: 340px;
  margin: 25px auto;
  padding: 25px;
  background: rgba(255,255,255,0.15);
  border-radius: 10px;
  backdrop-filter: blur(12px);
  box-shadow: 0 6px 18px rgba(0,0,0,0.4);
}

.form-box h2 {
  text-align: center;
  color: #a7faff;
  margin-bottom: 15px;
}

.form-box input, .form-box textarea, .form-box select {
  width: 100%;
  padding: 10px;
  margin: 10px 0;
  border-radius: 6px;
  border: 1px solid rgba(255,255,255,0.4);
  background: rgba(255,255,255,0.9);
  color: #333;
}

.form-box input:focus, .form-box textarea:focus {
  border-color: #48c6ef;
  box-shadow: 0 0 6px rgba(72,198,239,0.6);
}

.form-box button {
  width: 100%;
  padding: 12px;
  margin-top: 12px;
  background: linear-gradient(135deg, #48c6ef, #6f86d6);
  border: none;
  color: white;
  font-weight: bold;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.form-box button:hover {
  background: linear-gradient(135deg, #6f86d6, #48c6ef);
  box-shadow: 0 4px 10px rgba(0,0,0,0.4);
  transform: translateY(-2px);
}

.cart-table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 18px;
  border-radius: 8px;
  overflow: hidden;
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(6px);
}

.cart-table th, .cart-table td {
  border: 1px solid rgba(255,255,255,0.2);
  padding: 12px;
  text-align: center;
  color: #fff;
}

.cart-table th {
  background: linear-gradient(135deg, #48c6ef, #6f86d6);
}

.cart-table button {
  padding: 6px 12px;
  border: none;
  background: linear-gradient(135deg, #f857a6, #ff5858);
  color: white;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.cart-table button:hover {
  background: linear-gradient(135deg, #ff5858, #f857a6);
  transform: scale(1.05);
}

.buy-now-btn {
  margin-top: 20px;
  background: linear-gradient(135deg, #00c6ff, #0072ff);
  color: #fff;
  padding: 12px 25px;
  border: none;
  border-radius: 8px;
  font-weight: bold;
  font-size: 17px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.buy-now-btn:hover {
  transform: translateY(-3px);
  background: linear-gradient(135deg, #0072ff, #00c6ff);
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
}

.chart-container {
  display: flex;
  flex-wrap: wrap;
  gap: 20px;
  margin: 30px 0;
  justify-content: center;
}

.chart-section {
  flex: 1;
  min-width: 300px;
  max-width: 500px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 14px;
  padding: 20px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(10px);
}

.chart-section h2 {
  text-align: center;
  margin-top: 0;
  color: #a7faff;
  font-size: 1.2em;
  margin-bottom: 20px;
}

.chart-wrapper {
  position: relative;
  height: 300px;
  width: 100%;
}

@media (max-width: 768px) {
  .chart-section {
    width: 100%;
    max-width: 100%;
  }
}

</style>
</head>
<body>

<header>
  <h1>BuyBuddy</h1>
  <nav>
    <input type="text" id="searchInput" placeholder="Search product..." onkeyup="searchProducts()">
    <select id="categoryFilter" onchange="filterCategory()">
      <option value="">All Categories</option>
      <option value="mobiles">Mobiles</option>
      <option value="laptops">Laptops</option>
      <option value="cameras">Cameras</option>
      <option value="grocery">Grocery</option>
      <option value="clothing">Clothing</option>
    </select>
    <button onclick="showProfile()">Profile</button>
    <button onclick="showProducts()">Products</button>
    <button onclick="showCart()">Cart <span id="cart-count">0</span></button>
    <button onclick="showWishlist()">Wishlist <span id="wishlist-count">0</span></button>
    <button onclick="showOrderHistory()">Orders</button>
    <button onclick="logout()" id="logoutBtn" style="display:none;">Logout</button>
  </nav>
</header>

<div id="auth-section" class="container">
  <div class="form-box">
    <h2>Sign Up / Login</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="email" id="email" placeholder="Email">
    <button onclick="signup()">Continue</button>
    <p style="text-align: center; margin-top: 15px; color: #ccc;">
      By continuing, you agree to our Terms of Service and Privacy Policy
    </p>
  </div>
</div>

<div id="profile-section" class="container" style="display:none;">
  <h2>User Profile</h2>
  <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; max-width: 1000px; margin: 0 auto;">
    <div style="display: flex; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
      <div style="width: 80px; height: 80px; background: #48c6ef; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 20px; font-size: 36px; color: white; font-weight: bold;" id="profile-initial">
        U
      </div>
      <div>
          <h2 style="margin: 0; color: #e3fdfd;" id="profile-username">Username</h2>
          <p style="margin: 5px 0 0; color: #aaa;" id="profile-email">user@example.com</p>
        </div>
    </div>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px;">
      <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; text-align: center;">
        <div style="font-size: 24px; color: #48c6ef; font-weight: bold;" id="profile-orders">0</div>
        <div style="color: #aaa; font-size: 14px;">Total Orders</div>
      </div>
      <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; text-align: center;">
        <div style="font-size: 24px; color: #4CAF50; font-weight: bold;" id="profile-items">0</div>
        <div style="color: #aaa; font-size: 14px;">Cart Items</div>
      </div>
      <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; text-align: center;">
        <div style="font-size: 24px; color: #FFD700; font-weight: bold;" id="profile-wishlist">0</div>
        <div style="color: #aaa; font-size: 14px;">Wishlist</div>
      </div>
      <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px; text-align: center;">
        <div style="font-size: 24px; color: #ff6b6b; font-weight: bold;" id="profile-spent">‚Çπ0</div>
        <div style="color: #aaa; font-size: 14px;">Total Spent</div>
      </div>
    </div>

    <div class="chart-container">
      <div class="chart-section">
        <h2>Monthly Spending</h2>
        <div class="chart-wrapper">
          <canvas id="pieChart"></canvas>
        </div>
      </div>
      <div class="chart-section">
        <h2>Spending by Category</h2>
        <div class="chart-wrapper">
          <canvas id="barChart"></canvas>
        </div>
      </div>
    </div>
  </div>
</div>

<div id="cart-section" class="container" style="display:none;">
  <h2>Your Shopping Cart</h2>
  <table class="cart-table" id="cart-table">
    <thead>
      <tr>
        <th>Item</th>
        <th>Price</th>
        <th>Quantity</th>
        <th>Total</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <td colspan="5" style="text-align: right; padding: 15px;">
          <strong>Total: <span id="cart-total">‚Çπ0</span></strong>
        </td>
      </tr>
    </tfoot>
  </table>
  <button class="buy-now-btn" onclick="goToPayment()">Proceed to Checkout</button>
</div>

<div id="products-section" class="container" style="display:none;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap;">
    <h2 style="margin: 0;">Our Products</h2>
    <div>
      <select id="sortBy" onchange="filterCategory()" style="padding: 8px; border-radius: 6px; background: rgba(255,255,255,0.9); border: 1px solid rgba(0,0,0,0.1);">
        <option value="">Sort By</option>
        <option value="price_asc">Price: Low to High</option>
        <option value="price_desc">Price: High to Low</option>
        <option value="rating">Top Rated</option>
        <option value="newest">Newest First</option>
      </select>
    </div>
  </div>
  <div class="grid-container" id="product-grid"></div>
</div>

<div id="wishlist-section" class="container" style="display:none;">
  <h2>Your Wishlist</h2>
  <div class="grid-container" id="wishlist-grid"></div>
</div>

<div id="orders-section" class="container" style="display:none;">
  <h2>Your Orders</h2>
  <div id="orders-list">
    <div style="text-align: center; padding: 40px; color: #aaa;">
      <div style="font-size: 48px; margin-bottom: 20px;">üì¶</div>
      <h3>No Orders Yet</h3>
      <p>Your order history will appear here</p>
      <button onclick="showProducts()" style="margin-top: 20px; padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">Start Shopping</button>
    </div>
  </div>
</div>

<div id="payment-section" class="container" style="display:none;">
  <div class="form-box" style="max-width: 500px;">
    <h2>Checkout</h2>
    
    <div style="background: rgba(0,0,0,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
      <h3 style="margin-top: 0; color: #a7faff;">Order Summary</h3>
      <div id="order-summary" style="margin: 10px 0; line-height: 1.6;"></div>
      <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top: 10px; margin-top: 10px; font-weight: bold;">
        Total: <span id="order-total">‚Çπ0</span>
      </div>
    </div>

    <h3 style="color: #a7faff; margin-bottom: 15px;">Shipping Information</h3>
    <input type="text" id="fullName" placeholder="Full Name">
    <input type="tel" id="phone" placeholder="Phone Number">
    <textarea id="address" placeholder="Delivery Address" rows="3"></textarea>
    
    <h3 style="color: #a7faff; margin: 20px 0 15px;">Payment Method</h3>
    <div style="margin-bottom: 20px;">
      <div style="display: flex; align-items: center; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px; margin-bottom: 10px; cursor: pointer;">
        <input type="radio" id="cod" name="payment" value="cod" checked style="margin-right: 10px;">
        <label for="cod" style="flex-grow: 1; cursor: pointer;">Cash on Delivery</label>
        <span>üíµ</span>
      </div>
      <div style="display: flex; align-items: center; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px; margin-bottom: 10px; cursor: pointer;">
        <input type="radio" id="card" name="payment" value="card" style="margin-right: 10px;">
        <label for="card" style="flex-grow: 1; cursor: pointer;">Credit/Debit Card</label>
        <span>üí≥</span>
      </div>
      <div style="display: flex; align-items: center; background: rgba(255,255,255,0.1); padding: 12px; border-radius: 6px; cursor: pointer;">
        <input type="radio" id="upi" name="payment" value="upi" style="margin-right: 10px;">
        <label for="upi" style="flex-grow: 1; cursor: pointer;">UPI Payment</label>
        <span>üì±</span>
      </div>
    </div>

    <div id="card-details" style="display: none; background: rgba(0,0,0,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
      <input type="text" placeholder="Card Number" style="margin-bottom: 10px;">
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px;">
        <input type="text" placeholder="MM/YY">
        <input type="text" placeholder="CVV">
      </div>
      <input type="text" placeholder="Cardholder Name">
    </div>

    <div id="upi-details" style="display: none; background: rgba(0,0,0,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px; text-align: center;">
      <p style="margin-top: 0;">Pay using any UPI app</p>
      <div style="background: white; color: #333; padding: 10px; border-radius: 6px; font-family: monospace; margin-bottom: 10px;">
        buybuddy.merchant@upi
      </div>
      <p style="font-size: 12px; color: #aaa; margin-bottom: 0;">Or scan the QR code below</p>
      <div style="background: white; width: 120px; height: 120px; margin: 10px auto; display: flex; align-items: center; justify-content: center; border-radius: 8px;">
        <span style="font-size: 36px;">üì±</span>
      </div>
    </div>

    <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
      <label style="display: flex; align-items: flex-start; cursor: pointer;">
        <input type="checkbox" id="save-info" style="margin-right: 10px; margin-top: 3px;" checked>
        <span>Save my information for faster checkout</span>
      </label>
    </div>

    <button onclick="confirmPayment()" style="width: 100%; padding: 12px; background: #4CAF50; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer; transition: background 0.3s;">
      Place Order
    </button>
    
    <p style="text-align: center; margin-top: 15px; font-size: 12px; color: #aaa;">
      By placing your order, you agree to our Terms of Service and Privacy Policy
    </p>
  </div>
</div>

<footer>
  <div style="max-width: 1000px; margin: 0 auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; padding: 20px;">
    <div>
      <h3>About BuyBuddy</h3>
      <p>Your one-stop shop for all your shopping needs..</p>
    </div>
    <div>
      <h3>Quick Links</h3>
      <ul style="list-style: none; padding: 0;">
        <li><a href="#" style="color: #a7faff; text-decoration: none;" onclick="showProducts()">Products</a></li>
        <li><a href="#" style="color: #a7faff; text-decoration: none;" onclick="showCart()">Cart</a></li>
        <li><a href="#" style="color: #a7faff; text-decoration: none;" onclick="showWishlist()">Wishlist</a></li>
        <li><a href="#" style="color: #a7faff; text-decoration: none;" onclick="showOrderHistory()">Orders</a></li>
      </ul>
    </div>
    <div>
      <h3>Contact Us</h3>
      <p>Email: support@buybuddy.com<br>
     <br>
      </p>
    </div>
  </div>
  <div style="text-align: center; padding-top: 20px; border-top: 1px solid rgba(255,255,255,0.1); margin-top: 20px;">
    <p>BuyBuddy.</p>
  </div>
</footer>

<script>

let user = localStorage.getItem('currentUser') || '';
let userEmail = localStorage.getItem('userEmail') || '';
let cartItems = JSON.parse(localStorage.getItem('cart') || '[]');
let orders = JSON.parse(localStorage.getItem('orders') || '[]');
let wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
const currency = '‚Çπ';
let pieChart = null;
let barChart = null;
const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];

const products = [
  {
    id: 1,
    name: 'iPhone 15 Pro',
    price: 129999,
    category: 'mobiles',
    image: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-model-unselect-gallery-2-202309?wid=5120&hei=2880&fmt=p-jpg&qlt=80&.v=1693010535401',
    rating: 4.8,
    reviews: 1245,
    inStock: true
  },
  {
    id: 2,
    name: 'MacBook Pro 14"',
    price: 194900,
    category: 'laptops',
    image: 'https://images.macrumors.com/t/X5vOXZXAQbDf_Z_G3Rluf0T9klo=/1600x1200/smart/article-new/2024/10/M4-MacBook-Pro-Thumb-2.jpg',
    rating: 4.9,
    reviews: 892,
    inStock: true
  },
  {
    id: 3,
    name: 'Sony WH-1000XM5',
    price: 34990,
    category: 'audio',
    image: 'https://m.media-amazon.com/images/I/61XZQXFQeVL._AC_UF1000,1000_QL80_.jpg',
    rating: 4.7,
    reviews: 2341,
    inStock: true
  },
  {
    id: 4,
    name: 'Canon EOS R5',
    price: 339995,
    category: 'cameras',
    image: 'https://www.digitaltrends.com/wp-content/uploads/2020/07/canon-eos-r5-feature.jpg?resize=1200%2C720&p=1',
    rating: 4.8,
    reviews: 567,
    inStock: true
  },
  {
    id: 5,
    name: 'Organic Basmati Rice',
    price: 599,
    category: 'grocery',
    image: 'https://www.puremart.in/images/products/338-jammu-basmati-rice-1-kg-1602752338.jpeg',
    rating: 4.5,
    reviews: 3456,
    inStock: true
  },
  {
    id: 6,
    name: 'Nike Air Max',
    price: 12995,
    category: 'clothing',
    image: 'https://static.nike.com/a/images/t_PDP_1280_v1/f_auto,q_auto:eco/skwgyqrbfzhu6uyeh0gg/air-max-270-mens-shoes-KkLcCS.png',
    rating: 4.6,
    reviews: 1890,
    inStock: true
  },
  {
    id: 7,
    name: 'Samsung 55" QLED TV',
    price: 94990,
    category: 'electronics',
    image: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTuvijxfBg3Rv6MSPkVtyO6CYHaYC2XcfD7Vw&s',
    rating: 4.7,
    reviews: 1234,
    inStock: true
  },
  {
    id: 8,
    name: 'Instant Pot Duo',
    price: 9999,
    category: 'home',
    image: 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS6gsDq1LBBOFX7nXA369SzkH_WYOMlQsjydw&s',
    rating: 4.8,
    reviews: 23456,
    inStock: true
  }
];

document.addEventListener('DOMContentLoaded', function() {
  checkAuth();
  updateCartCount();
  updateWishlistCount();
  
  document.querySelectorAll('input[name="payment"]').forEach(radio => {
    radio.addEventListener('change', function() {
      document.getElementById('card-details').style.display = 
        this.value === 'card' ? 'block' : 'none';
      document.getElementById('upi-details').style.display = 
        this.value === 'upi' ? 'block' : 'none';
    });
  });
  
  if (localStorage.getItem('currentUser') && orders.length === 0) {
    addSampleOrders();
  }
  
  if (user) {
    showProducts();
  }
});

function signup() {
  const username = document.getElementById('username').value.trim();
  const email = document.getElementById('email').value.trim();
  
  if (!username || !email) {
    showToast('Please fill in all fields', 'error');
    return;
  }
  
  if (!isValidEmail(email)) {
    showToast('Please enter a valid email address', 'error');
    return;
  }
  
  user = username;
  userEmail = email;
  
  localStorage.setItem('currentUser', user);
  localStorage.setItem('userEmail', userEmail);
  
  showToast('Welcome to BuyBuddy!', 'success');

  document.getElementById('logoutBtn').style.display = 'inline-block';
  showProducts();

  if (orders.length === 0) {
    addSampleOrders();
  }
}

function logout() {
  user = '';
  userEmail = '';
  localStorage.removeItem('currentUser');
  localStorage.removeItem('userEmail');

  document.getElementById('logoutBtn').style.display = 'none';
  showAuth();
  showToast('You have been logged out', 'info');
}

function checkAuth() {
  if (user) {
    document.getElementById('logoutBtn').style.display = 'inline-block';
  } else {
    showAuth();
  }
}

function isValidEmail(email) {
  return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
}

function generateProducts(category = '', searchTerm = '') {
  const productGrid = document.getElementById('product-grid');
  if (!productGrid) return;
  
  productGrid.innerHTML = '';
  
  let filteredProducts = [...products];
  
  if (category) {
    filteredProducts = filteredProducts.filter(product => 
      product.category === category
    );
  }

  if (searchTerm) {
    const searchLower = searchTerm.toLowerCase();
    filteredProducts = filteredProducts.filter(product => 
      product.name.toLowerCase().includes(searchLower) || 
      product.category.toLowerCase().includes(searchLower)
    );
  }

  const sortBy = document.getElementById('sortBy')?.value;
  switch(sortBy) {
    case 'price_asc':
      filteredProducts.sort((a, b) => a.price - b.price);
      break;
    case 'price_desc':
      filteredProducts.sort((a, b) => b.price - a.price);
      break;
    case 'rating':
      filteredProducts.sort((a, b) => b.rating - a.rating);
      break;
    case 'newest':

      filteredProducts.sort((a, b) => b.id - a.id);
      break;
  }
  
  if (filteredProducts.length === 0) {
    productGrid.innerHTML = `
      <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #aaa;">
        <div style="font-size: 48px; margin-bottom: 20px;">üîç</div>
        <h3>No products found</h3>
        <p>Try adjusting your search or filter criteria</p>
        <button onclick="showProducts()" style="margin-top: 20px; padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">Show All Products</button>
      </div>
    `;
    return;
  }
  
  filteredProducts.forEach(product => {
    const isInWishlist = wishlist.includes(product.id);
    const productCard = document.createElement('div');
    productCard.className = `product-card ${!product.inStock ? 'out-of-stock' : ''}`;
    
    productCard.innerHTML = `
      <div class="wishlist-icon ${isInWishlist ? 'active' : ''}" onclick="toggleWishlist(${product.id}, event)">
        ${isInWishlist ? '‚ù§Ô∏è' : 'ü§ç'}
      </div>
      <img src="${product.image}" alt="${product.name}">
      <h3>${product.name}</h3>
      <div class="rating">
        ${'‚òÖ'.repeat(Math.floor(product.rating))}${'‚òÜ'.repeat(5 - Math.floor(product.rating))}
        <span class="review-count">(${product.reviews.toLocaleString()})</span>
      </div>
      <div class="price-section">
        <span class="current-price">${currency}${product.price.toLocaleString()}</span>
        <span class="discount-badge">10% OFF</span>
      </div>
      <button onclick="addToCart(${product.id})" ${!product.inStock ? 'disabled' : ''}>
        ${product.inStock ? 'Add to Cart' : 'Out of Stock'}
      </button>
    `;
    
    productGrid.appendChild(productCard);
  });
}

function updateChart() {
  updatePieChart();
  updateBarChart();
}

function updatePieChart() {
  const ctx = document.getElementById('pieChart');
  if (!ctx) return;
  
  const monthlyTotals = Array(12).fill(0);
  
  orders.forEach(order => {
    const month = new Date(order.date).getMonth();
    monthlyTotals[month] = (monthlyTotals[month] || 0) + order.total;
  });
  
  const currentMonth = new Date().getMonth();
  const cartTotal = cartItems.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
  monthlyTotals[currentMonth] = (monthlyTotals[currentMonth] || 0) + cartTotal;
  
  if (pieChart) {
    pieChart.data.datasets[0].data = monthlyTotals;
    pieChart.update();
  } else {
    pieChart = new Chart(ctx, {
      type: 'pie',
      data: {
        labels: months,
        datasets: [{
          label: 'Monthly Spending',
          data: monthlyTotals,
          backgroundColor: [
            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', 
            '#9966FF', '#FF9F40', '#8AC24A', '#FF5252',
            '#2196F3', '#FF9800', '#9C27B0', '#4CAF50'
          ],
          borderWidth: 0
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'right',
            labels: {
              color: '#fff',
              font: {
                size: 12
              }
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                const label = context.label || '';
                const value = context.raw || 0;
                const total = context.dataset.data.reduce((a, b) => a + b, 0);
                const percentage = total > 0 ? Math.round((value / total) * 100) : 0;
                return `${label}: ${currency}${value.toLocaleString()} (${percentage}%)`;
              }
            }
          }
        }
      }
    });
  }
}

function updateBarChart() {
  const ctx = document.getElementById('barChart');
  if (!ctx) return;

  const categories = {};
  orders.forEach(order => {
    order.items.forEach(item => {
      const category = item.category || 'Other';
      categories[category] = (categories[category] || 0) + (item.price * (item.quantity || 1));
    });
  });

  cartItems.forEach(item => {
    const category = item.category || 'Other';
    categories[category] = (categories[category] || 0) + (item.price * (item.quantity || 1));
  });
  
  const categoryLabels = Object.keys(categories);
  const categoryData = Object.values(categories);
  const backgroundColors = generateColors(categoryLabels.length);
  
  if (barChart) {
    barChart.data.labels = categoryLabels;
    barChart.data.datasets[0].data = categoryData;
    barChart.data.datasets[0].backgroundColor = backgroundColors;
    barChart.update();
  } else {
    barChart = new Chart(ctx, {
      type: 'bar',
      data: {
        labels: categoryLabels,
        datasets: [{
          label: 'Spending by Category',
          data: categoryData,
          backgroundColor: backgroundColors,
          borderWidth: 0,
          borderRadius: 4
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            display: false
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return `${context.dataset.label}: ${currency}${context.raw.toLocaleString()}`;
              }
            }
          }
        },
        scales: {
          x: {
            grid: {
              display: false,
              drawBorder: false
            },
            ticks: {
              color: '#fff'
            }
          },
          y: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)',
              drawBorder: false
            },
            ticks: {
              color: '#fff',
              callback: function(value) {
                return currency + value.toLocaleString();
              }
            }
          }
        }
      }
    });
  }
}

function generateColors(count) {
  const colors = [];
  const hueStep = 360 / Math.max(1, count);
  
  for (let i = 0; i < count; i++) {
    const hue = (i * hueStep) % 360;
    colors.push(`hsl(${hue}, 70%, 60%)`);
  }
  
  return colors;
}

function showAuth() {
  hideAllSections();
  document.getElementById('auth-section').style.display = 'block';
}

function showProducts() {
  hideAllSections();
  document.getElementById('products-section').style.display = 'block';
  generateProducts();
}

function showCart() {
  if (!user) {
    showAuth();
    showToast('Please sign in to view your cart', 'error');
    return;
  }
  
  hideAllSections();
  document.getElementById('cart-section').style.display = 'block';
  updateCartView();
}

function showWishlist() {
  if (!user) {
    showAuth();
    showToast('Please sign in to view your wishlist', 'error');
    return;
  }
  
  hideAllSections();
  document.getElementById('wishlist-section').style.display = 'block';
  updateWishlistView();
}

function showOrderHistory() {
  if (!user) {
    showAuth();
    showToast('Please sign in to view your orders', 'error');
    return;
  }
  
  hideAllSections();
  document.getElementById('orders-section').style.display = 'block';
  updateOrdersView();
}

function showProfile() {
  if (!user) {
    showAuth();
    return;
  }
  
  hideAllSections();
  document.getElementById('profile-section').style.display = 'block';

  document.getElementById('profile-username').textContent = user;
  document.getElementById('profile-email').textContent = userEmail;
  document.getElementById('profile-initial').textContent = user ? user.charAt(0).toUpperCase() : 'U';
  document.getElementById('profile-items').textContent = cartItems.reduce((sum, item) => sum + (item.quantity || 1), 0);
  document.getElementById('profile-orders').textContent = orders.length;

  const wishlist = JSON.parse(localStorage.getItem('wishlist') || '[]');
  document.getElementById('profile-wishlist').textContent = wishlist.length;

  const totalSpent = orders.reduce((sum, order) => sum + order.total, 0);
  document.getElementById('profile-spent').textContent = currency + totalSpent.toLocaleString();

  updateChart();
}

function hideAllSections() {
  document.querySelectorAll('.container, #payment-section').forEach(section => {
    section.style.display = 'none';
  });
}

function addToCart(productId) {
  if (!user) {
    showAuth();
    showToast('Please sign in to add items to cart', 'error');
    return;
  }
  
  const product = products.find(p => p.id === productId);
  if (!product) return;
  
  const existingItem = cartItems.find(item => item.id === productId);
  
  if (existingItem) {
    existingItem.quantity = (existingItem.quantity || 1) + 1;
  } else {
    cartItems.push({
      ...product,
      quantity: 1
    });
  }
  
  localStorage.setItem('cart', JSON.stringify(cartItems));
  updateCartCount();
  showToast(`${product.name} added to cart`, 'success');

  if (document.getElementById('cart-section').style.display === 'block') {
    updateCartView();
  }
}

function removeFromCart(index) {
  cartItems.splice(index, 1);
  localStorage.setItem('cart', JSON.stringify(cartItems));
  updateCartView();
  updateCartCount();
  showToast('Item removed from cart', 'info');
}

function updateCartView() {
  const tbody = document.querySelector('#cart-table tbody');
  if (!tbody) return;
  
  tbody.innerHTML = '';
  
  if (cartItems.length === 0) {
    document.getElementById('cart-section').innerHTML = `
      <div style="text-align: center; padding: 40px; color: #aaa;">
        <div style="font-size: 48px; margin-bottom: 20px;">üõí</div>
        <h3>Your cart is empty</h3>
        <p>Looks like you haven't added anything to your cart yet</p>
        <button onclick="showProducts()" style="margin-top: 20px; padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">Browse Products</button>
      </div>
    `;
    return;
  }
  
  let total = 0;
  
  cartItems.forEach((item, index) => {
    const tr = document.createElement('tr');
    const itemTotal = item.price * (item.quantity || 1);
    total += itemTotal;
    
    tr.innerHTML = `
      <td style="display: flex; align-items: center;">
        <img src="${item.image}" alt="${item.name}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 4px; margin-right: 10px;">
        <div>
          <div style="font-weight: 500;">${item.name}</div>
          <div style="font-size: 12px; color: #aaa;">${item.category}</div>
        </div>
      </td>
      <td>${currency}${item.price.toLocaleString()}</td>
      <td>
        <div style="display: flex; align-items: center; justify-content: center;">
          <button onclick="updateQuantity(${index}, ${(item.quantity || 1) - 1})" style="background: #333; color: white; border: none; width: 25px; height: 25px; border-radius: 4px; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center;">-</button>
          <span style="margin: 0 10px; min-width: 20px; text-align: center;">${item.quantity || 1}</span>
          <button onclick="updateQuantity(${index}, ${(item.quantity || 1) + 1})" style="background: #48c6ef; color: white; border: none; width: 25px; height: 25px; border-radius: 4px; cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center;">+</button>
        </div>
      </td>
      <td>${currency}${itemTotal.toLocaleString()}</td>
      <td>
        <button onclick="removeFromCart(${index})" style="background: #ff4d4d; color: white; border: none; border-radius: 4px; padding: 5px 10px; cursor: pointer; display: flex; align-items: center; justify-content: center; margin: 0 auto;">
          <span style="font-size: 16px;">üóëÔ∏è</span>
        </button>
      </td>
    `;
    
    tbody.appendChild(tr);
  });
  
  document.getElementById('cart-total').textContent = `${currency}${total.toLocaleString()}`;
}

function updateQuantity(index, newQuantity) {
  if (newQuantity < 1) return;
  
  cartItems[index].quantity = newQuantity;
  localStorage.setItem('cart', JSON.stringify(cartItems));
  updateCartView();
  updateCartCount();
}

function updateCartCount() {
  const count = cartItems.reduce((sum, item) => sum + (item.quantity || 1), 0);
  document.getElementById('cart-count').textContent = count;

  if (document.getElementById('profile-items')) {
    document.getElementById('profile-items').textContent = count;
  }
}

function toggleWishlist(productId, event) {
  if (!user) {
    showAuth();
    showToast('Please sign in to manage your wishlist', 'error');
    return;
  }
  
  event.stopPropagation();
  const index = wishlist.indexOf(productId);
  
  if (index === -1) {
    wishlist.push(productId);
    showToast('Added to wishlist', 'success');
  } else {
    wishlist.splice(index, 1);
    showToast('Removed from wishlist', 'info');
  }
  
  localStorage.setItem('wishlist', JSON.stringify(wishlist));
  updateWishlistCount();
  updateWishlistView();
  
  const wishlistIcons = document.querySelectorAll('.wishlist-icon');
  wishlistIcons.forEach(icon => {
    if (parseInt(icon.getAttribute('data-product-id')) === productId) {
      icon.innerHTML = index === -1 ? '‚ù§Ô∏è' : 'ü§ç';
      icon.classList.toggle('active', index === -1);
    }
  });
  
  if (document.getElementById('products-section').style.display === 'block') {
    generateProducts();
  }
}

function updateWishlistView() {
  const wishlistGrid = document.getElementById('wishlist-grid');
  if (!wishlistGrid) return;
  
  wishlistGrid.innerHTML = '';
  
  if (wishlist.length === 0) {
    wishlistGrid.innerHTML = `
      <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #aaa;">
        <div style="font-size: 48px; margin-bottom: 20px;">‚ù§Ô∏è</div>
        <h3>Your wishlist is empty</h3>
        <p>Save items you love for later</p>
        <button onclick="showProducts()" style="margin-top: 20px; padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">Browse Products</button>
      </div>
    `;
    return;
  }
  
  const wishlistProducts = products.filter(product => wishlist.includes(product.id));
  
  wishlistProducts.forEach(product => {
    const productCard = document.createElement('div');
    productCard.className = 'product-card';
    
    productCard.innerHTML = `
      <div class="wishlist-icon active" onclick="toggleWishlist(${product.id}, event)">
        ‚ù§Ô∏è
      </div>
      <img src="${product.image}" alt="${product.name}">
      <h3>${product.name}</h3>
      <div class="price-section">
        <span class="current-price">${currency}${product.price.toLocaleString()}</span>
        <span class="discount-badge">10% OFF</span>
      </div>
      <button onclick="addToCart(${product.id})">
        Add to Cart
      </button>
    `;
    
    wishlistGrid.appendChild(productCard);
  });
}

function updateWishlistCount() {
  document.getElementById('wishlist-count').textContent = wishlist.length;
  
  if (document.getElementById('profile-wishlist')) {
    document.getElementById('profile-wishlist').textContent = wishlist.length;
  }
}

function updateOrdersView() {
  const ordersList = document.getElementById('orders-list');
  if (!ordersList) return;
  
  if (orders.length === 0) {
    ordersList.innerHTML = `
      <div style="text-align: center; padding: 40px; color: #aaa;">
        <div style="font-size: 48px; margin-bottom: 20px;">üì¶</div>
        <h3>No Orders Yet</h3>
        <p>Your order history will appear here</p>
        <button onclick="showProducts()" style="margin-top: 20px; padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">Start Shopping</button>
      </div>
    `;
    return;
  }
  
  const container = document.createElement('div');
  container.className = 'orders-container';
  
  orders.forEach((order, index) => {
    const orderDate = new Date(order.date);
    const formattedDate = orderDate.toLocaleDateString('en-US', {
      year: 'numeric',
      month: 'short',
      day: 'numeric'
    });
    
    let statusClass = 'status-pending';
    if (order.status === 'delivered') statusClass = 'status-delivered';
    else if (order.status === 'cancelled') statusClass = 'status-cancelled';
    
    const orderCard = document.createElement('div');
    orderCard.className = 'order-card';
    orderCard.style.marginBottom = '20px';
    
    orderCard.innerHTML = `
      <div class="order-header">
        <div>
          <div style="font-size: 14px; color: #aaa;">Order Placed</div>
          <div style="font-weight: 500;">${formattedDate}</div>
        </div>
        <div style="text-align: right;">
          <div style="font-size: 14px; color: #aaa;">Total</div>
          <div style="font-weight: 500;">${currency}${order.total.toLocaleString()}</div>
        </div>
      </div>
      <div style="margin-top: 10px; font-size: 14px;">
        Order #${order.id} ‚Ä¢ 
        <span class="order-status ${statusClass}">${order.status.charAt(0).toUpperCase() + order.status.slice(1)}</span>
      </div>
      <div class="order-items" id="order-items-${order.id}">
        <!-- Order items will be populated here -->
      </div>
      <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(255,255,255,0.1); display: flex; justify-content: flex-end; gap: 10px;">
        ${order.status === 'pending' ? `
          <button onclick="cancelOrder('${order.id}')" class="outline-btn">Cancel Order</button>
          <button onclick="trackOrder('${order.id}')" class="primary-btn">Track Order</button>
        ` : order.status === 'delivered' ? ` 
          <button onclick="returnItem('${order.id}')" class="outline-btn">Return or Replace</button>
          <button onclick="buyAgain('${order.id}')" class="primary-btn">Buy Again</button>
        ` : ''}
      </div>
    `;
    
    container.appendChild(orderCard);
    
    const orderItemsContainer = document.getElementById(`order-items-${order.id}`);
    order.items.forEach(item => {
      const itemElement = document.createElement('div');
      itemElement.className = 'order-item';
      itemElement.innerHTML = `
        <img src="${item.image}" alt="${item.name}" style="width: 60px; height: 60px; object-fit: cover; border-radius: 4px;">
        <div style="flex-grow: 1; margin: 0 15px;">
          <div style="font-weight: 500; margin-bottom: 5px;">${item.name}</div>
          <div style="font-size: 14px; color: #aaa;">Qty: ${item.quantity}</div>
        </div>
        <div style="font-weight: 500;">${currency}${item.price.toLocaleString()}</div>
      `;
      orderItemsContainer.appendChild(itemElement);
    });
  });

  if (!container.parentNode) {
    ordersList.innerHTML = '';
    ordersList.appendChild(container);
  }
}

function cancelOrder(orderId) {
  const order = orders.find(o => o.id === orderId);
  if (!order) return;
  
  order.status = 'cancelled';
  localStorage.setItem('orders', JSON.stringify(orders));
  updateOrdersView();
  showToast('Order cancelled', 'info');
}

function trackOrder(orderId) {
  showToast('Tracking information will be available soon', 'info');
}

function returnItem(orderId) {
  showToast('Return request submitted', 'success');
}

function buyAgain(orderId) {
  const order = orders.find(o => o.id === orderId);
  if (!order) return;
  
  order.items.forEach(item => {
    const existingItem = cartItems.find(cartItem => cartItem.id === item.id);
    if (existingItem) {
      existingItem.quantity = (existingItem.quantity || 1) + (item.quantity || 1);
    } else {
      cartItems.push({...item});
    }
  });
  
  localStorage.setItem('cart', JSON.stringify(cartItems));
  updateCartCount();
  showToast('Items added to cart', 'success');
  showCart();
}

function addSampleOrders() {
  if (orders.length > 0) return;
  
  const sampleOrders = [
    {
      id: 'ORD' + (Date.now() - 86400000),
      date: new Date(Date.now() - 86400000).toISOString(),
      items: [
        {
          id: 1,
          name: 'iPhone 15 Pro',
          price: 129999,
          quantity: 1,
          image: 'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-model-unselect-gallery-2-202309?wid=5120&hei=2880&fmt=p-jpg&qlt=80&.v=1693010535401',
          category: 'mobiles'
        }
      ],
      total: 129999,
      status: 'delivered',
      shippingAddress: '123 Main St, Bangalore, Karnataka 560001',
      paymentMethod: 'card'
    },
    {
      id: 'ORD' + (Date.now() - 172800000),
      date: new Date(Date.now() - 172800000).toISOString(),
      items: [
        {
          id: 6,
          name: 'Nike Air Max',
          price: 12995,
          quantity: 2,
          image: 'https://static.nike.com/a/images/t_PDP_1280_v1/f_auto,q_auto:eco/skwgyqrbfzhu6uyeh0gg/air-max-270-mens-shoes-KkLcCS.png',
          category: 'clothing'
        },
        {
          id: 3,
          name: 'Sony WH-1000XM5',
          price: 34990,
          quantity: 1,
          image: 'https://m.media-amazon.com/images/I/61XZQXFQeVL._AC_UF1000,1000_QL80_.jpg',
          category: 'audio'
        }
      ],
      total: 60980,
      status: 'delivered',
      shippingAddress: '123 Main St, Bangalore, Karnataka 560001',
      paymentMethod: 'upi'
    }
  ];
  
  orders = [...sampleOrders];
  localStorage.setItem('orders', JSON.stringify(orders));
}

function goToPayment() {
  if (cartItems.length === 0) {
    showToast('Your cart is empty!', 'error');
    return;
  }
  
  hideAllSections();
  document.getElementById('payment-section').style.display = 'block';

  const orderSummary = document.getElementById('order-summary');
  const total = cartItems.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
  
  let summaryHTML = '';
  cartItems.forEach(item => {
    summaryHTML += `
      <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
        <span>${item.name} x${item.quantity || 1}</span>
        <span>${currency}${(item.price * (item.quantity || 1)).toLocaleString()}</span>
      </div>
    `;
  });
  
  summaryHTML += `
    <div style="border-top: 1px dashed rgba(255,255,255,0.3); margin: 10px 0; padding-top: 10px;">
      <div style="display: flex; justify-content: space-between; font-weight: bold;">
        <span>Total:</span>
        <span>${currency}${total.toLocaleString()}</span>
      </div>
    </div>
  `;
  
  orderSummary.innerHTML = summaryHTML;
  document.getElementById('order-total').textContent = `${currency}${total.toLocaleString()}`;
  
  if (user) {
    document.getElementById('fullName').value = user;
    document.getElementById('email').value = userEmail;
  }
}

function confirmPayment() {
  const fullName = document.getElementById('fullName').value.trim();
  const phone = document.getElementById('phone').value.trim();
  const address = document.getElementById('address').value.trim();
  const paymentMethod = document.querySelector('input[name="payment"]:checked')?.value;
  
  if (!fullName || !phone || !address || !paymentMethod) {
    showToast('Please fill in all required fields', 'error');
    return;
  }

  const orderId = 'ORD' + Date.now();
  const orderDate = new Date().toISOString();
  const total = cartItems.reduce((sum, item) => sum + (item.price * (item.quantity || 1)), 0);
  
  const order = {
    id: orderId,
    date: orderDate,
    items: cartItems.map(item => ({
      id: item.id,
      name: item.name,
      price: item.price,
      quantity: item.quantity || 1,
      image: item.image,
      category: item.category
    })),
    total: total,
    status: 'pending',
    shippingAddress: address,
    paymentMethod: paymentMethod
  };

  orders.unshift(order);
  localStorage.setItem('orders', JSON.stringify(orders));

  cartItems = [];
  localStorage.setItem('cart', JSON.stringify(cartItems));
  updateCartCount();
 
  showToast('Order placed successfully!', 'success');
  
  showOrderHistory();
 
  const ordersList = document.getElementById('orders-list');
  ordersList.innerHTML = `
    <div style="text-align: center; padding: 40px; color: #4CAF50;">
      <div style="font-size: 72px; margin-bottom: 20px;">üéâ</div>
      <h2>Order Placed Successfully!</h2>
      <p>Your order #${orderId} has been confirmed</p>
      <p>We've sent a confirmation email to ${userEmail}</p>
      <div style="margin: 30px auto; max-width: 500px; background: rgba(76, 175, 80, 0.1); border-radius: 8px; padding: 20px; text-align: left;">
        <h3 style="margin-top: 0; color: #4CAF50;">Order Summary</h3>
        <div style="margin-bottom: 15px;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
            <span>Order Number:</span>
            <span>#${orderId}</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
            <span>Date:</span>
            <span>${new Date(orderDate).toLocaleDateString()}</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
            <span>Total:</span>
            <span>${currency}${total.toLocaleString()}</span>
          </div>
          <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
            <span>Payment Method:</span>
            <span>${paymentMethod.toUpperCase()}</span>
          </div>
        </div>
      </div>
      <div style="display: flex; gap: 15px; justify-content: center; margin-top: 30px;">
        <button onclick="showOrderHistory()" style="padding: 10px 20px; background: #48c6ef; color: white; border: none; border-radius: 6px; cursor: pointer;">View Orders</button>
        <button onclick="showProducts()" style="padding: 10px 20px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer;">Continue Shopping</button>
      </div>
    </div>
  `;
}

function searchProducts() {
  const searchTerm = document.getElementById('searchInput').value.trim();
  const category = document.getElementById('categoryFilter').value;
  generateProducts(category, searchTerm);
}

function filterCategory() {
  const category = document.getElementById('categoryFilter').value;
  const searchTerm = document.getElementById('searchInput').value.trim();
  generateProducts(category, searchTerm);
}

function showToast(message, type = 'info') {
  
  const existingToasts = document.querySelectorAll('.toast');
  existingToasts.forEach(toast => toast.remove());
  
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  toast.textContent = message;
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.style.opacity = '0';
    toast.style.transform = 'translateY(20px)';
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

if (localStorage.getItem('currentUser') && orders.length === 0) {
  addSampleOrders();
}

if (localStorage.getItem('currentUser') && (!localStorage.getItem('wishlist') || JSON.parse(localStorage.getItem('wishlist')).length === 0)) {
  localStorage.setItem('wishlist', JSON.stringify([1, 3, 7]));
  updateWishlistCount();
}
</script>

</body>
</html>